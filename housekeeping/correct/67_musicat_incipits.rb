incipitrism = [["A0001-00-01-C1S1", "120000717", "1.1.1", nil], ["A0001-00-02-C1b", "120000717", "1.1.2", nil], ["A0002-00-01-C1S", "120000718", "1.1.1", nil], ["A0002-00-02-C1b", "120000718", "1.1.2", nil], ["A0003-00-01-S1", "120000719", "1.1.1", nil], ["A0003-00-02-acomp", "120000719", "1.1.2", nil], ["A0004-00-01-C1S", "120000720", "1.1.1", nil], ["A0004-00-02-C1b", "120000720", "1.1.2", nil], ["A0005-00-01-S1", "120000721", "1.1.1", nil], ["A0005-00-02-acomparp", "120000721", "1.1.2", nil], ["A0006-00-01-C1S", "120000722", "1.1.1", nil], ["A0006-00-02-C1b", "120000722", "1.1.2", nil], ["A0007-00-01-C1A", "120000723", "1.1.1", nil], ["A0007-00-02-C1b", "120000723", "1.1.2", nil], ["A0008-00-01-T1", "120000724", "1.1.1", nil], ["A0008-00-02-acomp", "120000724", "1.1.2", nil], ["A0009-00-01-T1", "120000725", "1.1.1", nil], ["A0009-00-02-acomp", "120000725", "1.1.2", nil], ["A0010-00-01-S", "120000726", "1.1.1", nil], ["A0010-00-02-b", "120000726", "1.1.2", nil], ["A0011-00-01-C1T", "120000727", "1.1.1", nil], ["A0011-00-02-acomp", "120000727", "1.1.2", nil], ["A0012-00-01-C1T", "120000728", "1.1.1", nil], ["A0012-00-02-acomparp", "120000728", "1.1.2", nil], ["A0013-00-01-A", "120000729", "1.1.1", nil], ["A0013-00-02-acomp", "120000729", "1.1.2", nil], ["A0014-00-01-C1A", "120000730", "1.1.1", nil], ["A0014-00-02-acomp", "120000730", "1.1.2", nil], ["A0015-00-01-C1S1", "120000731", "1.1.1", nil], ["A0015-00-02-acomp", "120000731", "1.1.2", nil], ["A0016-00-01-T1", "120000732", "1.1.1", nil], ["A0016-00-02-acomp", "120000732", "1.1.2", nil], ["A0017-00-01-T1", "120000733", "1.1.1", nil], ["A0017-00-02-acomp", "120000733", "1.1.2", nil], ["A0018-00-01-T1", "120000734", "1.1.1", nil], ["A0018-00-02-acomp", "120000734", "1.1.2", nil], ["A0019-00-01-C1T", "120000735", "1.1.1", nil], ["A0019-00-02-acomp", "120000735", "1.1.2", nil], ["A0020-00-01-T", "120000736", "1.1.1", nil], ["A0020-00-02-b", "120000736", "1.1.2", nil], ["A0021-00-01-T", "120000737", "1.1.1", nil], ["A0021-00-02-b", "120000737", "1.1.2", nil], ["A0022-00-01-T1", "120000738", "1.1.1", nil], ["A0022-00-02-b1", "120000738", "1.1.2", nil], ["A0023-00-01-C1S", "120000739", "1.1.1", nil], ["A0023-00-02-C1b", "120000739", "1.1.2", nil], ["A0024-00-01-C1T", "120000740", "1.1.1", nil], ["A0024-00-02-acomp", "120000740", "1.1.2", nil], ["A0025-00-01-C1A", "120000741", "1.1.1", nil], ["A0025-00-02-acomp", "120000741", "1.1.2", nil], ["A0026-00-01-T", "120000742", "1.1.1", nil], ["A0026-00-02-b", "120000742", "1.1.2", nil], ["A0027-00-01-T1", "120000743", "1.1.1", nil], ["A0027-00-02-acomp", "120000743", "1.1.2", nil], ["A0028-00-01-C1S", "120000744", "1.1.1", nil], ["A0028-00-02-acomp", "120000744", "1.1.2", nil], ["A0029-00-01-S", "120000745", "1.1.1", nil], ["A0029-00-02-b", "120000745", "1.1.2", nil], ["A0030-00-01-T1", "120000746", "1.1.1", nil], ["A0030-00-02-acomp", "120000746", "1.1.2", nil], ["A0031-00-01-C1A", "120000747", "1.1.1", nil], ["A0031-00-02-acomp", "120000747", "1.1.2", nil], ["A0032-00-01-C1S", "120000748", "1.1.1", nil], ["A0032-00-02-acomp", "120000748", "1.1.2", nil], ["A0033-00-01-T", "120000749", "1.1.1", nil], ["A0033-00-02-b", "120000749", "1.1.2", nil], ["A0034-00-01-T1", "120000750", "1.1.1", nil], ["A0034-00-02-acomp", "120000750", "1.1.2", nil], ["A0035-00-01-C1S", "120000751", "1.1.1", nil], ["A0035-00-02-acomp", "120000751", "1.1.2", nil], ["A0036-00-01-T", "120000752", "1.1.1", nil], ["A0036-00-02-b", "120000752", "1.1.2", nil], ["A0037-00-01-T1", "120000753", "1.1.1", nil], ["A0037-00-02-b1", "120000753", "1.1.2", nil], ["A0038-00-01-C1T", "120000754", "1.1.1", nil], ["A0038-00-02-acomp", "120000754", "1.1.2", nil], ["A0039-00-01-C1S", "120000755", "1.1.1", nil], ["A0039-00-02-acomp", "120000755", "1.1.2", nil], ["A0040-00-01-C1S", "120000756", "1.1.1", nil], ["A0040-00-02-acomp", "120000756", "1.1.2", nil], ["A0041-00-01-C1A", "120000757", "1.1.1", nil], ["A0041-00-02-acomp", "120000757", "1.1.2", nil], ["A0042-00-01-T1", "120000758", "1.1.1", nil], ["A0042-00-02-acomp", "120000758", "1.1.2", nil], ["A0043-00-01-T1", "120000759", "1.1.1", nil], ["A0043-00-02-acomp", "120000759", "1.1.2", nil], ["A0044-00-01-C1T", "120000760", "1.1.1", nil], ["A0044-00-02-C1b", "120000760", "1.1.2", nil], ["A0045-00-01-T1", "120000761", "1.1.1", nil], ["A0045-00-02-b1", "120000761", "1.1.2", nil], ["A0046-00-01-C1S", "120000762", "1.1.1", nil], ["A0046-00-02-C1b", "120000762", "1.1.2", nil], ["A0047-00-01-A1", "120000763", "1.1.1", nil], ["A0047-00-02-b1", "120000763", "1.1.2", nil], ["A0048-00-01-T", "120000764", "1.1.1", nil], ["A0049-00-01-C1T", "120000765", "1.1.1", nil], ["A0049-00-02-C1b", "120000765", "1.1.2", nil], ["A0050-00-01-C1A", "120000766", "1.1.1", nil], ["A0050-00-02-C1b", "120000766", "1.1.2", nil], ["A0051-00-01-C1S", "120000767", "1.1.1", nil], ["A0051-00-02-C1b", "120000767", "1.1.2", nil], ["A0052-00-01-C1S", "120000768", "1.1.1", nil], ["A0052-00-02-C1b", "120000768", "1.1.2", nil], ["A0054-00-01-S1", "120000769", "1.1.1", nil], ["A0054-00-02-b", "120000769", "1.1.2", nil], ["A0055-00-01-S1", "120000770", "1.1.1", nil], ["A0055-00-02-acomp", "120000770", "1.1.2", nil], ["A0056-00-01-T1", "120000771", "1.1.1", nil], ["A0056-00-02-acomp", "120000771", "1.1.2", nil], ["A0057-00-01-S1", "120000772", "1.1.1", nil], ["A0057-00-02-acomp", "120000772", "1.1.2", nil], ["A0058-00-01-A1", "120000773", "1.1.1", nil], ["A0058-00-02-acomp", "120000773", "1.1.2", nil], ["A0059-00-01-T1", "120000774", "1.1.1", nil], ["A0059-00-02-acomp", "120000774", "1.1.2", nil], ["A0060-00-01-C1S", "120000775", "1.1.1", nil], ["A0060-00-02-acomp", "120000775", "1.1.2", nil], ["A0061-00-01-T", "120000776", "1.1.1", nil], ["A0061-00-02-vl1", "120000776", "1.1.2", nil], ["A0062-00-01-C1A", "120000777", "1.1.1", nil], ["A0062-00-02-acomp", "120000777", "1.1.2", nil], ["A0063-00-01-C1A", "120000778", "1.1.1", nil], ["A0063-00-02-acomp", "120000778", "1.1.2", nil], ["A0064-00-01-T1", "120000779", "1.1.1", nil], ["A0064-00-02-acomp", "120000779", "1.1.2", nil], ["A0065-00-01-T1", "120000780", "1.1.1", nil], ["A0065-00-02-b", "120000780", "1.1.2", nil], ["A0066-00-01-A", "120000781", "1.1.1", nil], ["A0066-00-02-b", "120000781", "1.1.2", nil], ["A0067-00-01-T", "120000782", "1.1.1", nil], ["A0067-00-02-acomp", "120000782", "1.1.2", nil], ["A0068-00-01-C1T", "120000783", "1.1.1", nil], ["A0068-00-02-acomp", "120000783", "1.1.2", nil], ["A0069-00-01-C1S", "120000784", "1.1.1", nil], ["A0069-00-02-acomp", "120000784", "1.1.2", nil], ["A0070-00-01-C1A", "120000785", "1.1.1", nil], ["A0070-00-02-acomp", "120000785", "1.1.2", nil], ["A0071-00-01-C1S", "120000786", "1.1.1", nil], ["A0071-00-02-acomp", "120000786", "1.1.2", nil], ["A0072-00-01-C1T", "120000787", "1.1.1", nil], ["A0072-00-02-acomp", "120000787", "1.1.2", nil], ["A0073-00-01-C1T", "120000788", "1.1.1", nil], ["A0073-00-02-acomp", "120000788", "1.1.2", nil], ["A0074-00-01-A", "120000789", "1.1.1", nil], ["A0074-00-02-acomp", "120000789", "1.1.2", nil], ["A0075-00-01-C1A", "120000790", "1.1.1", nil], ["A0075-00-02-acomp", "120000790", "1.1.2", nil], ["A0076-00-01-C1A", "120000791", "1.1.1", nil], ["A0076-00-02-C1b", "120000791", "1.1.2", nil], ["A0077-00-01-S1", "120000792", "1.1.1", nil], ["A0077-00-02-b", "120000792", "1.1.2", nil], ["A0078-00-01-T1", "120000793", "1.1.1", nil], ["A0080-00-01-S1", "120000794", "1.1.1", nil], ["A0080-00-02-acomp", "120000794", "1.1.2", nil], ["A0081-00-01-C1T", "120000795", "1.1.1", nil], ["A0081-00-02-acomp", "120000795", "1.1.2", nil], ["A0082-00-01-S1", "120000796", "1.1.1", nil], ["A0082-00-02-acomp", "120000796", "1.1.2", nil], ["A0083-00-01-A", "120000797", "1.1.1", nil], ["A0083-00-02-acomp", "120000797", "1.1.2", nil], ["A0084-00-01-A", "120000798", "1.1.1", nil], ["A0085-00-01-C1T", "120000799", "1.1.1", nil], ["A0085-00-02-acomp", "120000799", "1.1.2", nil], ["A0086-00-01-T1", "120000800", "1.1.1", nil], ["A0086-00-02-acomp", "120000800", "1.1.2", nil], ["A0087-00-01-C1S", "120000801", "1.1.1", nil], ["A0087-00-02-vl1", "120000801", "1.1.2", nil], ["A0088-00-01-T", "120000802", "1.1.1", nil], ["A0089-00-01-T", "120000803", "1.1.1", nil], ["A0089-00-02-vl1", "120000803", "1.1.2", nil], ["A0090-00-01-T", "120000700", "1.1.1", nil], ["A0090-00-03-T", "120000700", "1.2.1", nil], ["A0090-00-05-T", "120000700", "1.3.1", nil], ["A0090-00-02-vl1", "120000700", "1.1.2", nil], ["A0090-00-04-acomp", "120000700", "1.2.2", nil], ["A0090-00-06-vl1", "120000700", "1.3.2", nil], ["A0092-00-01-T", "120000701", "1.1.1", nil], ["A0092-00-03-T", "120000701", "1.2.1", nil], ["A0092-00-05-T", "120000701", "1.3.1", nil], ["A0092-00-02-vl1", "120000701", "1.1.2", nil], ["A0092-00-04-acomp", "120000701", "1.2.2", nil], ["A0092-00-06-vl1", "120000701", "1.3.2", nil], ["A0093-00-01-A", "120000804", "1.1.1", nil], ["A0093-00-02-vl1", "120000804", "1.1.2", nil], ["A0094-00-01-C1S", "120000805", "1.1.1", nil], ["A0094-00-02-vl1", "120000805", "1.1.2", nil], ["A0095-00-01-S", "120000702", "1.1.1", nil], ["A0095-00-03-S", "120000702", "1.2.1", nil], ["A0095-00-05-S", "120000702", "1.3.1", nil], ["A0095-00-02-vl1", "120000702", "1.1.2", nil], ["A0095-00-04-vl1", "120000702", "1.2.2", nil], ["A0095-00-06-vl1", "120000702", "1.3.2", nil], ["A0097-00-01-C1S1", "120000806", "1.1.1", nil], ["A0097-00-02-vl1", "120000806", "1.1.2", nil], ["A0098-00-01-A", "120000807", "1.1.1", nil], ["A0098-00-02-acomp", "120000807", "1.1.2", nil], ["A0102-00-01-S1", "120000808", "1.1.1", nil], ["A0102-00-02-vl1", "120000808", "1.1.2", nil], ["A0103-00-01-S1", "120000703", "1.1.1", nil], ["A0103-00-03-S1", "120000703", "1.2.1", nil], ["A0103-00-05-S1", "120000703", "1.3.1", nil], ["A0103-00-07-S1", "120000703", "1.4.1", nil], ["A0103-00-02-vl1", "120000703", "1.1.2", nil], ["A0103-00-04-acomp", "120000703", "1.2.2", nil], ["A0103-00-06-vl1", "120000703", "1.3.2", nil], ["A0103-00-08-vl1", "120000703", "1.4.2", nil], ["A0104-00-01-S1", "120000809", "1.1.1", nil], ["A0104-00-02-vl1", "120000809", "1.1.2", nil], ["A0105-00-01-A", "120000810", "1.1.1", nil], ["A0105-00-02-b", "120000810", "1.1.2", nil], ["A0107-00-01-S", "120000811", "1.1.1", nil], ["A0107-00-02-vl1", "120000811", "1.1.2", nil], ["A0108-00-01-S1", "120000704", "1.1.1", nil], ["A0108-00-03-S1", "120000704", "1.2.1", nil], ["A0108-00-05-S1", "120000704", "1.3.1", nil], ["A0108-00-07-S1", "120000704", "1.4.1", nil], ["A0108-00-09-S1", "120000704", "1.5.1", nil], ["A0108-00-11-S1", "120000704", "1.6.1", nil], ["A0108-00-02-vl1", "120000704", "1.1.2", nil], ["A0108-00-04-vl1", "120000704", "1.2.2", nil], ["A0108-00-06-vl1", "120000704", "1.3.2", nil], ["A0108-00-08-vl1", "120000704", "1.4.2", nil], ["A0108-00-10-vl1", "120000704", "1.5.2", nil], ["A0108-00-12-vl1", "120000704", "1.6.2", nil], ["A0109-00-01-C1T", "120000705", "1.1.1", nil], ["A0109-00-02-C1T", "120000705", "1.2.1", nil], ["A0109-00-03-C1T", "120000705", "1.3.1", nil], ["A0109-00-04-C1T", "120000705", "1.4.1", nil], ["A0109-00-05-C1T", "120000705", "1.5.1", nil], ["A0110-00-01-S", "120000706", "1.1.1", nil], ["A0110-00-03-S", "120000706", "1.2.1", nil], ["A0110-00-02-acomp", "120000706", "1.1.2", nil], ["A0110-00-04-vl1", "120000706", "1.2.2", nil], ["A0111-00-01-S1", "120000812", "1.1.1", nil], ["A0111-00-02-vl1", "120000812", "1.1.2", nil], ["A0112-00-01-S1", "120000813", "1.1.1", nil], ["A0112-00-02-vl1", "120000813", "1.1.2", nil], ["A0114-00-01-S1", "120000707", "1.1.1", nil], ["A0114-00-03-T", "120000707", "1.2.1", nil], ["A0114-00-05-S1", "120000707", "1.3.1", nil], ["A0114-00-07-S1", "120000707", "1.4.1", nil], ["A0114-00-08-S1", "120000707", "1.5.1", nil], ["A0114-00-02-vl1", "120000707", "1.1.2", nil], ["A0114-00-04-vl1", "120000707", "1.2.2", nil], ["A0114-00-06-vl1", "120000707", "1.3.2", nil], ["A0114-00-09-vl2", "120000707", "1.5.2", nil], ["A0115-00-01-S1", "120000814", "1.1.1", nil], ["A0115-00-02-b2", "120000814", "1.1.2", nil], ["A0116-00-01-C1S", "120000708", "1.1.1", nil], ["A0116-00-03-C1S", "120000708", "1.2.1", nil], ["A0116-00-05-C1S", "120000708", "1.3.1", nil], ["A0116-00-07-C1S", "120000708", "1.4.1", nil], ["A0116-00-02-vl1", "120000708", "1.1.2", nil], ["A0116-00-04-acomp", "120000708", "1.2.2", nil], ["A0116-00-06-vl1", "120000708", "1.3.2", nil], ["A0116-00-08-vl1", "120000708", "1.4.2", nil], ["A0118-00-01-C1T", "120000815", "1.1.1", nil], ["A0118-00-02-vl1", "120000815", "1.1.2", nil], ["A0119-00-01-S1", "120000816", "1.1.1", nil], ["A0119-00-02-vl1", "120000816", "1.1.2", nil], ["A0120-00-01-S1", "120000817", "1.1.1", nil], ["A0120-00-02-vl1", "120000817", "1.1.2", nil], ["A0121-00-01-A", "120000818", "1.1.1", nil], ["A0121-00-02-vl1", "120000818", "1.1.2", nil], ["A0127-00-01-B", "120000709", "1.1.1", nil], ["A0127-00-03-B", "120000709", "1.2.1", nil], ["A0127-00-02-acomp", "120000709", "1.1.2", nil], ["A0127-00-04-vl1", "120000709", "1.2.2", nil], ["A0240-00-01-C1S", "120000819", "1.1.1", nil], ["A0240-00-02-vl1", "120000819", "1.1.2", nil], ["A0511-00-01-A1", "120000820", "1.1.1", nil], ["A0511-00-02-vl1", "120000820", "1.1.2", nil], ["A0556-00-01-S1", "120000821", "1.1.1", nil], ["A0556-00-02-vl1", "120000821", "1.1.2", nil], ["A0559-00-01-A", "120000822", "1.1.1", nil], ["A0559-00-02-vl1", "120000822", "1.1.2", nil], ["A0561-00-01-A", "120000710", "1.1.1", nil], ["A0561-00-03-A", "120000710", "1.2.1", nil], ["A0561-00-02-acomp", "120000710", "1.1.2", nil], ["A0561-00-04-vl1", "120000710", "1.2.2", nil], ["A0562-00-01-S1", "120000823", "1.1.1", nil], ["A0562-00-02-vl2", "120000823", "1.1.2", nil], ["A0563-00-01-S1", "120000824", "1.1.1", nil], ["A0563-00-02-vl1", "120000824", "1.1.2", nil], ["A0564-00-01-S1", "120000825", "1.1.1", nil], ["A0564-00-02-vl1", "120000825", "1.1.2", nil], ["A0566-00-01-B", "120000711", "1.1.1", nil], ["A0566-00-03-B", "120000711", "1.2.1", nil], ["A0566-00-05-S", "120000711", "1.3.1", nil], ["A0566-00-07-B", "120000711", "1.4.1", nil], ["A0566-00-09-S", "120000711", "1.5.1", nil], ["A0566-00-11-S1", "120000711", "1.6.1", nil], ["A0566-00-13-T", "120000711", "1.7.1", nil], ["A0566-00-15-T", "120000711", "1.8.1", nil], ["A0566-00-02-acomp", "120000711", "1.1.2", nil], ["A0566-00-04-vl1", "120000711", "1.2.2", nil], ["A0566-00-06-acomp", "120000711", "1.3.2", nil], ["A0566-00-08-vl1", "120000711", "1.4.2", nil], ["A0566-00-10-acomp", "120000711", "1.5.2", nil], ["A0566-00-12-vl1", "120000711", "1.6.2", nil], ["A0566-00-14-acomp", "120000711", "1.7.2", nil], ["A0566-00-16-vl1", "120000711", "1.8.2", nil], ["A0568-00-01-C1S1", "120000826", "1.1.1", nil], ["A0568-00-02-vl1", "120000826", "1.1.2", nil], ["A0570-00-01-S1", "120000827", "1.1.1", nil], ["A0570-00-02-vl1", "120000827", "1.1.2", nil], ["A0571-00-01-S1", "120000828", "1.1.1", nil], ["A0571-00-02-vl1", "120000828", "1.1.2", nil], ["A0572-00-01-S1", "120000829", "1.1.1", nil], ["A0572-00-02-vl1", "120000829", "1.1.2", nil], ["A0573-00-01-C1S1", "120000830", "1.1.1", nil], ["A0573-00-02-vl1", "120000830", "1.1.2", nil], ["A0575-00-01-A", "120000831", "1.1.1", nil], ["A0575-00-02-vl1", "120000831", "1.1.2", nil], ["A1182-00-01-S1", "120000712", "1.1.1", nil], ["A1182-00-03-S2", "120000712", "1.2.1", nil], ["A1182-00-05-S2", "120000712", "1.3.1", nil], ["A1182-00-07-A", "120000712", "1.4.1", nil], ["A1182-00-09-A", "120000712", "1.5.1", nil], ["A1182-00-11-S1", "120000712", "1.6.1", nil], ["A1182-00-02-vl1", "120000712", "1.1.2", nil], ["A1182-00-04-acomp", "120000712", "1.2.2", nil], ["A1182-00-06-vl1", "120000712", "1.3.2", nil], ["A1182-00-08-acomp", "120000712", "1.4.2", nil], ["A1182-00-10-vl1", "120000712", "1.5.2", nil], ["A1182-00-12-vl1", "120000712", "1.6.2", nil], ["A1185-00-01-S1", "120000832", "1.1.1", nil], ["A1185-00-02-org", "120000832", "1.1.2", nil], ["A1243-00-01-S", "120000713", "1.1.1", nil], ["A1243-00-03-S", "120000713", "1.2.1", nil], ["A1243-00-02-acomp", "120000713", "1.1.2", nil], ["A1243-00-04-acomp", "120000713", "1.2.2", nil], ["A1485-00-01-S1", "120000833", "1.1.1", nil], ["A1485-00-02-acomp", "120000833", "1.1.2", nil], ["A1487-00-01-S", "120000834", "1.1.1", nil], ["A1487-00-02-vl1", "120000834", "1.1.2", nil], ["A1492-00-01-S", "120000714", "1.1.1", nil], ["A1492-00-03-S", "120000714", "1.2.1", nil], ["A1492-00-05-S", "120000714", "1.3.1", nil], ["A1492-00-07-S", "120000714", "1.4.1", nil], ["A1492-00-02-acomp", "120000714", "1.1.2", nil], ["A1492-00-04-vl1", "120000714", "1.2.2", nil], ["A1492-00-06-acomp", "120000714", "1.3.2", nil], ["A1492-00-08-vl1", "120000714", "1.4.2", nil], ["A1501-00-01-S1", "120000835", "1.1.1", nil], ["A1501-00-02-vl1", "120000835", "1.1.2", nil], ["A1841-00-01-A", "120000836", "1.1.1", nil], ["A1841-00-02-vl", "120000836", "1.1.2", nil], ["A1843-00-01-S", "120000837", "1.1.1", nil], ["A1843-00-02-acomp", "120000837", "1.1.2", nil], ["A1844-00-01-S", "120000838", "1.1.1", nil], ["A1844-00-02-vl1", "120000838", "1.1.2", nil], ["A1847-00-01-C1S1", "120000839", "1.1.1", nil], ["A1847-00-02-vl1", "120000839", "1.1.2", nil], ["A1848-00-01-S1", "120000840", "1.1.1", nil], ["A1848-00-02-vl1", "120000840", "1.1.2", nil], ["A1850-00-01-C1S2", "120000841", "1.1.1", nil], ["A1850-00-02-b", "120000841", "1.1.2", nil], ["A1851-00-01-vl1", "120000842", "1.1.1", nil], ["A1854-00-01-vl1", "120000843", "1.1.1", nil], ["A1856-00-01-T", "120000715", "1.1.1", nil], ["A1856-00-03-T", "120000715", "1.2.1", nil], ["A1856-00-02-acomp", "120000715", "1.1.2", nil], ["A1856-00-04-vl1", "120000715", "1.2.2", nil], ["A1857-00-01-C1S1", "120000844", "1.1.1", nil], ["A1857-00-02-vl1", "120000844", "1.1.2", nil], ["A1858-00-01-S1", "120000716", "1.1.1", nil], ["A1858-00-03-C1A", "120000716", "1.2.1", nil], ["A1858-00-05-S", "120000716", "1.3.1", nil], ["A1858-00-07-S", "120000716", "1.4.1", " "], ["A1858-00-09-S", "120000716", "1.5.1", nil], ["A1858-00-11-S", "120000716", "1.6.1", nil], ["A1858-00-02-acomp", "120000716", "1.1.2", nil], ["A1858-00-04-vl1", "120000716", "1.2.2", nil], ["A1858-00-06-acomp", "120000716", "1.3.2", nil], ["A1858-00-08-vl1", "120000716", "1.4.2", nil], ["A1858-00-10-acomp", "120000716", "1.5.2", nil], ["A1858-00-12-vl1", "120000716", "1.6.2", nil], ["A1859-00-01-S1", "120000845", "1.1.1", nil], ["A1859-00-02-acomp", "120000845", "1.1.2", nil], ["A1861-00-01-T", "120000846", "1.1.1", nil], ["A1868-00-01-S1", "120000847", "1.1.1", nil], ["A1868-00-02-b", "120000847", "1.1.2", nil], ["A1869-00-01-C1S1", "120000848", "1.1.1", nil], ["A1869-00-02-vl1", "120000848", "1.1.2", nil], ["A1870-00-01-C1S1", "120000849", "1.1.1", nil], ["A1870-00-03-S", "120000849", "1.2.1", nil], ["A1870-00-05-S", "120000849", "1.3.1", nil], ["A1870-00-02-vl1", "120000849", "1.1.2", nil], ["A1870-00-04-acomp", "120000849", "1.2.2", nil], ["A1870-00-06-vl1", "120000849", "1.3.2", nil], ["A1871-00-01-S", "120000850", "1.1.1", nil], ["A1871-00-02-vl1", "120000850", "1.1.2", nil], ["A1876-00-01-T", "120000851", "1.1.1", nil], ["A1876-00-02-vl1", "120000851", "1.1.2", nil], ["A2014-00-01-S1", "120000852", "1.1.1", nil], ["A2014-00-02-vl1", "120000852", "1.1.2", nil], ["A2016-00-01-S1", "120000853", "1.1.1", nil], ["A2016-00-02-vl1", "120000853", "1.1.2", nil], ["A2020-00-01-S", "120000854", "1.1.1", nil], ["A2020-00-02-vl1", "120000854", "1.1.2", nil], ["A2025-00-01-C2B", "120000855", "1.1.1", nil], ["A2025-00-02-vl1", "120000855", "1.1.2", nil], ["A2026-00-01-C1S1", "120000856", "1.1.1", nil], ["A2026-00-02-vl1", "120000856", "1.1.2", nil], ["A2027-00-01-S1", "120000857", "1.1.1", nil], ["A2027-00-02-vl1", "120000857", "1.1.2", nil], ["A2161-01-01-S", "120003027", "1.1.1", nil], ["A2161-01-02-vl1", "120003027", "1.1.2", nil]]


def get_pae_tag(marc, index)

    numbers = index.split(".")

    marc.each_by_tag("031") do |node|
        a = node.fetch_first_by_tag("a").content.strip
        b = node.fetch_first_by_tag("b").content.strip
        c = node.fetch_first_by_tag("c").content.strip

        if a == numbers[0] && b == numbers[1] && c == numbers[2]
            return node
        end
    end

    nil
end

def file_to_lines(filename)
    result = {}
    File.open(filename, "r") do |f|
        f.each_line do |line|
            if line.starts_with?("@clef")
                data = line.gsub!("@clef:", "")
                result[:clef] = data.strip
            elsif line.starts_with?("@keysig")
                data = line.gsub!("@keysig:", "")
                result[:key] = data.strip
            elsif line.starts_with?("@timesig")
                data = line.gsub!("@timesig:", "")
                result[:time] = data.strip
            elsif line.starts_with?("@data")
                data = line.gsub!("@data:", "")
                result[:pae] = data.strip
            end
        end
    end

    result
end

incipitrism.each do |line|

    file = line[0]
    id = line[1]
    nr = line[2]

    source = Source.find(id)

    node = get_pae_tag(source.marc, nr)

    if !node
        puts "Not found #{id} #{nr}"
        next
    end

    pae = file_to_lines("musicat_incipits/PAE/" + file + ".pae")

    begin
        node.fetch_first_by_tag("p").content = pae[:pae]
    rescue NoMethodError
        node.add_at(MarcNode.new("source", "p", pae[:pae], nil), 0 )
    end

    begin
        node.fetch_first_by_tag("n").content = pae[:key]
    rescue NoMethodError
        node.add_at(MarcNode.new("source", "n", pae[:key], nil), 0 )
    end

    begin
        node.fetch_first_by_tag("g").content = pae[:clef]
    rescue NoMethodError
        node.add_at(MarcNode.new("source", "g", pae[:clef], nil), 0 )
    end
    
    begin
        node.fetch_first_by_tag("o").content = pae[:time]
    rescue NoMethodError
        node.add_at(MarcNode.new("source", "o", pae[:time], nil), 0 )
    end

    node.sort_alphabetically

    source.save


    obj = DigitalObject.create(:attachment => File.open("musicat_incipits/MEI/" + file + ".mei", 'rb'), :description => "#{source.id}:#{nr}")
    dol = DigitalObjectLink.create(object_link_type: "Source", object_link_id: source.id, user: source.user, digital_object_id: obj.id)
end